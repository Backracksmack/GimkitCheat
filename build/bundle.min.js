!function(){"use strict";function t(t,e){return t[e.offset++]}function e(t,e){return t[e.offset++]|t[e.offset++]<<8}function n(t,e){return t[e.offset++]|t[e.offset++]<<8|t[e.offset++]<<16|t[e.offset++]<<24}function i(t,e){return n(t,e)>>>0}const s=new Int32Array(2),r=new Float32Array(s.buffer),o=new Float64Array(s.buffer);function a(n,s){const r=n[s.offset++];let o;r<192?o=31&r:217===r?o=t(n,s):218===r?o=e(n,s):219===r&&(o=i(n,s));const a=function(t,e,n){for(var i="",s=0,r=e,o=e+n;r<o;r++){var a=t[r];0!=(128&a)?192!=(224&a)?224!=(240&a)?240!=(248&a)?console.error("Invalid byte "+a.toString(16)):(s=(7&a)<<18|(63&t[++r])<<12|(63&t[++r])<<6|(63&t[++r])<<0)>=65536?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s):i+=String.fromCharCode((15&a)<<12|(63&t[++r])<<6|(63&t[++r])<<0):i+=String.fromCharCode((31&a)<<6|63&t[++r]):i+=String.fromCharCode(a)}return i}(n,s.offset,o);return s.offset+=o,a}function l(a,l){const h=a[l.offset++];return h<128?h:202===h?function(t,e){return s[0]=n(t,e),r[0]}(a,l):203===h?function(t,e){return s[0]=n(t,e),s[1]=n(t,e),o[0]}(a,l):204===h?t(a,l):205===h?e(a,l):206===h?i(a,l):207===h?function(t,e){const n=i(t,e);return i(t,e)*Math.pow(2,32)+n}(a,l):208===h?function(e,n){return t(e,n)<<24>>24}(a,l):209===h?function(t,n){return e(t,n)<<16>>16}(a,l):210===h?n(a,l):211===h?function(t,e){const s=i(t,e);return n(t,e)*Math.pow(2,32)+s}(a,l):h>223?-1*(255-h+1):void 0}const h=13;function d(t,e){if(this._offset=e,t instanceof ArrayBuffer)this._buffer=t,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(t))throw new Error("Invalid argument");this._buffer=t.buffer,this._view=new DataView(this._buffer,t.byteOffset,t.byteLength)}}function u(t,e,n){for(var i=0,s=0,r=n.length;s<r;s++)(i=n.charCodeAt(s))<128?t.setUint8(e++,i):i<2048?(t.setUint8(e++,192|i>>6),t.setUint8(e++,128|63&i)):i<55296||i>=57344?(t.setUint8(e++,224|i>>12),t.setUint8(e++,128|i>>6&63),t.setUint8(e++,128|63&i)):(s++,i=65536+((1023&i)<<10|1023&n.charCodeAt(s)),t.setUint8(e++,240|i>>18),t.setUint8(e++,128|i>>12&63),t.setUint8(e++,128|i>>6&63),t.setUint8(e++,128|63&i))}function c(t,e,n){var i=typeof n,s=0,r=0,o=0,a=0,l=0,h=0;if("string"===i){if(l=function(t){for(var e=0,n=0,i=0,s=t.length;i<s;i++)(e=t.charCodeAt(i))<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(i++,n+=4);return n}(n),l<32)t.push(160|l),h=1;else if(l<256)t.push(217,l),h=2;else if(l<65536)t.push(218,l>>8,l),h=3;else{if(!(l<4294967296))throw new Error("String too long");t.push(219,l>>24,l>>16,l>>8,l),h=5}return e.push({_str:n,_length:l,_offset:t.length}),h+l}if("number"===i)return Math.floor(n)===n&&isFinite(n)?n>=0?n<128?(t.push(n),1):n<256?(t.push(204,n),2):n<65536?(t.push(205,n>>8,n),3):n<4294967296?(t.push(206,n>>24,n>>16,n>>8,n),5):(o=n/Math.pow(2,32)>>0,a=n>>>0,t.push(207,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),9):n>=-32?(t.push(n),1):n>=-128?(t.push(208,n),2):n>=-32768?(t.push(209,n>>8,n),3):n>=-2147483648?(t.push(210,n>>24,n>>16,n>>8,n),5):(o=Math.floor(n/Math.pow(2,32)),a=n>>>0,t.push(211,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),9):(t.push(203),e.push({_float:n,_length:8,_offset:t.length}),9);if("object"===i){if(null===n)return t.push(192),1;if(Array.isArray(n)){if((l=n.length)<16)t.push(144|l),h=1;else if(l<65536)t.push(220,l>>8,l),h=3;else{if(!(l<4294967296))throw new Error("Array too large");t.push(221,l>>24,l>>16,l>>8,l),h=5}for(s=0;s<l;s++)h+=c(t,e,n[s]);return h}if(n instanceof Date){var d=n.getTime();return o=Math.floor(d/Math.pow(2,32)),a=d>>>0,t.push(215,0,o>>24,o>>16,o>>8,o,a>>24,a>>16,a>>8,a),10}if(n instanceof ArrayBuffer){if((l=n.byteLength)<256)t.push(196,l),h=2;else if(l<65536)t.push(197,l>>8,l),h=3;else{if(!(l<4294967296))throw new Error("Buffer too large");t.push(198,l>>24,l>>16,l>>8,l),h=5}return e.push({_bin:n,_length:l,_offset:t.length}),h+l}if("function"==typeof n.toJSON)return c(t,e,n.toJSON());var u=[],p="",f=Object.keys(n);for(s=0,r=f.length;s<r;s++)"function"!=typeof n[p=f[s]]&&u.push(p);if((l=u.length)<16)t.push(128|l),h=1;else if(l<65536)t.push(222,l>>8,l),h=3;else{if(!(l<4294967296))throw new Error("Object too large");t.push(223,l>>24,l>>16,l>>8,l),h=5}for(s=0;s<l;s++)h+=c(t,e,p=u[s]),h+=c(t,e,n[p]);return h}if("boolean"===i)return t.push(n?195:194),1;if("undefined"===i)return t.push(212,0,0),3;throw new Error("Could not encode")}function p(t){var e=[],n=[],i=c(e,n,t),s=new ArrayBuffer(i),r=new DataView(s),o=0,a=0,l=-1;n.length>0&&(l=n[0]._offset);for(var h,d=0,p=0,f=0,g=e.length;f<g;f++)if(r.setUint8(a+f,e[f]),f+1===l){if(d=(h=n[o])._length,p=a+l,h._bin)for(var m=new Uint8Array(h._bin),v=0;v<d;v++)r.setUint8(p+v,m[v]);else h._str?u(r,p,h._str):void 0!==h._float&&r.setFloat64(p,h._float);a+=d,n[++o]&&(l=n[o]._offset)}return s}d.prototype._array=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this._parse();return e},d.prototype._map=function(t){for(var e={},n=0;n<t;n++)e[this._parse()]=this._parse();return e},d.prototype._str=function(t){var e=function(t,e,n){for(var i="",s=0,r=e,o=e+n;r<o;r++){var a=t.getUint8(r);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));(s=(7&a)<<18|(63&t.getUint8(++r))<<12|(63&t.getUint8(++r))<<6|(63&t.getUint8(++r))<<0)>=65536?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s)}else i+=String.fromCharCode((15&a)<<12|(63&t.getUint8(++r))<<6|(63&t.getUint8(++r))<<0);else i+=String.fromCharCode((31&a)<<6|63&t.getUint8(++r));else i+=String.fromCharCode(a)}return i}(this._view,this._offset,t);return this._offset+=t,e},d.prototype._bin=function(t){var e=this._buffer.slice(this._offset,this._offset+t);return this._offset+=t,e},d.prototype._parse=function(){var t,e=this._view.getUint8(this._offset++),n=0,i=0,s=0,r=0;if(e<192)return e<128?e:e<144?this._map(15&e):e<160?this._array(15&e):this._str(31&e);if(e>223)return-1*(255-e+1);switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this._view.getUint8(this._offset),this._offset+=1,this._bin(n);case 197:return n=this._view.getUint16(this._offset),this._offset+=2,this._bin(n);case 198:return n=this._view.getUint32(this._offset),this._offset+=4,this._bin(n);case 199:return n=this._view.getUint8(this._offset),i=this._view.getInt8(this._offset+1),this._offset+=2,[i,this._bin(n)];case 200:return n=this._view.getUint16(this._offset),i=this._view.getInt8(this._offset+2),this._offset+=3,[i,this._bin(n)];case 201:return n=this._view.getUint32(this._offset),i=this._view.getInt8(this._offset+4),this._offset+=5,[i,this._bin(n)];case 202:return t=this._view.getFloat32(this._offset),this._offset+=4,t;case 203:return t=this._view.getFloat64(this._offset),this._offset+=8,t;case 204:return t=this._view.getUint8(this._offset),this._offset+=1,t;case 205:return t=this._view.getUint16(this._offset),this._offset+=2,t;case 206:return t=this._view.getUint32(this._offset),this._offset+=4,t;case 207:return s=this._view.getUint32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,s+r;case 208:return t=this._view.getInt8(this._offset),this._offset+=1,t;case 209:return t=this._view.getInt16(this._offset),this._offset+=2,t;case 210:return t=this._view.getInt32(this._offset),this._offset+=4,t;case 211:return s=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,s+r;case 212:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?void(this._offset+=1):[i,this._bin(1)];case 213:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(2)];case 214:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(4)];case 215:return i=this._view.getInt8(this._offset),this._offset+=1,0===i?(s=this._view.getInt32(this._offset)*Math.pow(2,32),r=this._view.getUint32(this._offset+4),this._offset+=8,new Date(s+r)):[i,this._bin(8)];case 216:return i=this._view.getInt8(this._offset),this._offset+=1,[i,this._bin(16)];case 217:return n=this._view.getUint8(this._offset),this._offset+=1,this._str(n);case 218:return n=this._view.getUint16(this._offset),this._offset+=2,this._str(n);case 219:return n=this._view.getUint32(this._offset),this._offset+=4,this._str(n);case 220:return n=this._view.getUint16(this._offset),this._offset+=2,this._array(n);case 221:return n=this._view.getUint32(this._offset),this._offset+=4,this._array(n);case 222:return n=this._view.getUint16(this._offset),this._offset+=2,this._map(n);case 223:return n=this._view.getUint32(this._offset),this._offset+=4,this._map(n)}throw new Error("Could not parse")};var f={decode:function(t){const e=new Uint8Array(t),n=Array.from(e);if(n[0]==h){let e={offset:1};return!function(t,e){const n=t[e.offset];return n<192&&n>160||217===n||218===n||219===n}(n,e)?l(n,e):a(n,e),function(t,e){void 0===e&&(e=0);var n=new d(t,e),i=n._parse();if(n._offset!==t.byteLength)throw new Error(t.byteLength-n._offset+" trailing bytes");return i}(t,e.offset)}return null},encode:function(t,e){let n=[h],i=p(t),s=p(e),r=new Uint8Array(i.byteLength+s.byteLength+n.length);return r.set(n),r.set(new Uint8Array(i),n.length),r.set(new Uint8Array(s),n.length+i.byteLength),r.buffer}};function g(t,e,n){for(var i=0,s=0,r=n.length;s<r;s++)(i=n.charCodeAt(s))<128?t.setUint8(e++,i):(i<2048?t.setUint8(e++,192|i>>6):(i<55296||57344<=i?t.setUint8(e++,224|i>>12):(s++,i=65536+((1023&i)<<10|1023&n.charCodeAt(s)),t.setUint8(e++,240|i>>18),t.setUint8(e++,128|i>>12&63)),t.setUint8(e++,128|i>>6&63)),t.setUint8(e++,128|63&i))}var m={encode:function(t,e,n){return function(t){var e=[],n=[],i=function t(e,n,i){var s=typeof i,r=0,o=0,a=0,l=0,h=0,d=0;if("string"===s){if((h=function(t){for(var e=0,n=0,i=0,s=t.length;i<s;i++)(e=t.charCodeAt(i))<128?n+=1:e<2048?n+=2:e<55296||57344<=e?n+=3:(i++,n+=4);return n}(i))<32)e.push(160|h),d=1;else if(h<256)e.push(217,h),d=2;else if(h<65536)e.push(218,h>>8,h),d=3;else{if(!(h<4294967296))throw new Error("String too long");e.push(219,h>>24,h>>16,h>>8,h),d=5}return n.push({h:i,u:h,t:e.length}),d+h}if("number"===s)return Math.floor(i)===i&&isFinite(i)?0<=i?i<128?(e.push(i),1):i<256?(e.push(204,i),2):i<65536?(e.push(205,i>>8,i),3):i<4294967296?(e.push(206,i>>24,i>>16,i>>8,i),5):(a=i/Math.pow(2,32)>>0,l=i>>>0,e.push(207,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):-32<=i?(e.push(i),1):-128<=i?(e.push(208,i),2):-32768<=i?(e.push(209,i>>8,i),3):-2147483648<=i?(e.push(210,i>>24,i>>16,i>>8,i),5):(a=Math.floor(i/Math.pow(2,32)),l=i>>>0,e.push(211,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),9):(e.push(203),n.push({o:i,u:8,t:e.length}),9);if("object"===s){if(null===i)return e.push(192),1;if(Array.isArray(i)){if((h=i.length)<16)e.push(144|h),d=1;else if(h<65536)e.push(220,h>>8,h),d=3;else{if(!(h<4294967296))throw new Error("Array too large");e.push(221,h>>24,h>>16,h>>8,h),d=5}for(r=0;r<h;r++)d+=t(e,n,i[r]);return d}if(i instanceof Date){var u=i.getTime();return a=Math.floor(u/Math.pow(2,32)),l=u>>>0,e.push(215,0,a>>24,a>>16,a>>8,a,l>>24,l>>16,l>>8,l),10}if(i instanceof ArrayBuffer){if((h=i.byteLength)<256)e.push(196,h),d=2;else if(h<65536)e.push(197,h>>8,h),d=3;else{if(!(h<4294967296))throw new Error("Buffer too large");e.push(198,h>>24,h>>16,h>>8,h),d=5}return n.push({l:i,u:h,t:e.length}),d+h}if("function"==typeof i.toJSON)return t(e,n,i.toJSON());var c=[],p="",f=Object.keys(i);for(r=0,o=f.length;r<o;r++)"function"!=typeof i[p=f[r]]&&c.push(p);if((h=c.length)<16)e.push(128|h),d=1;else if(h<65536)e.push(222,h>>8,h),d=3;else{if(!(h<4294967296))throw new Error("Object too large");e.push(223,h>>24,h>>16,h>>8,h),d=5}for(r=0;r<h;r++)d+=t(e,n,p=c[r]),d+=t(e,n,i[p]);return d}if("boolean"===s)return e.push(i?195:194),1;if("undefined"===s)return e.push(212,0,0),3;throw new Error("Could not encode")}(e,n,t),s=new ArrayBuffer(i),r=new DataView(s),o=0,a=0,l=-1;0<n.length&&(l=n[0].t);for(var h,d=0,u=0,c=0,p=e.length;c<p;c++)if(r.setUint8(a+c,e[c]),c+1===l){if(d=(h=n[o]).u,u=a+l,h.l)for(var f=new Uint8Array(h.l),m=0;m<d;m++)r.setUint8(u+m,f[m]);else h.h?g(r,u,h.h):void 0!==h.o&&r.setFloat64(u,h.o);a+=d,n[++o]&&(l=n[o].t)}let v=Array.from(new Uint8Array(s));return v.unshift(4),new Uint8Array(v).buffer}({type:2,data:["blueboat_SEND_MESSAGE",{room:n,key:t,data:e}],options:{compress:!0},nsp:"/"})},decode:function(t){function e(t){if(this.t=0,t instanceof ArrayBuffer)this.i=t,this.s=new DataView(this.i);else{if(!ArrayBuffer.isView(t))return null;this.i=t.buffer,this.s=new DataView(this.i,t.byteOffset,t.byteLength)}}e.prototype.g=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=this.v();return e},e.prototype.M=function(t){for(var e={},n=0;n<t;n++)e[this.v()]=this.v();return e},e.prototype.h=function(t){var e=function(t,e,n){for(var i="",s=0,r=e,o=e+n;r<o;r++){var a=t.getUint8(r);if(0!=(128&a))if(192!=(224&a))if(224!=(240&a)){if(240!=(248&a))throw new Error("Invalid byte "+a.toString(16));65536<=(s=(7&a)<<18|(63&t.getUint8(++r))<<12|(63&t.getUint8(++r))<<6|(63&t.getUint8(++r))<<0)?(s-=65536,i+=String.fromCharCode(55296+(s>>>10),56320+(1023&s))):i+=String.fromCharCode(s)}else i+=String.fromCharCode((15&a)<<12|(63&t.getUint8(++r))<<6|(63&t.getUint8(++r))<<0);else i+=String.fromCharCode((31&a)<<6|63&t.getUint8(++r));else i+=String.fromCharCode(a)}return i}(this.s,this.t,t);return this.t+=t,e},e.prototype.l=function(t){var e=this.i.slice(this.t,this.t+t);return this.t+=t,e},e.prototype.v=function(){if(!this.s)return null;var t,e=this.s.getUint8(this.t++),n=0,i=0,s=0,r=0;if(e<192)return e<128?e:e<144?this.M(15&e):e<160?this.g(15&e):this.h(31&e);if(223<e)return-1*(255-e+1);switch(e){case 192:return null;case 194:return!1;case 195:return!0;case 196:return n=this.s.getUint8(this.t),this.t+=1,this.l(n);case 197:return n=this.s.getUint16(this.t),this.t+=2,this.l(n);case 198:return n=this.s.getUint32(this.t),this.t+=4,this.l(n);case 199:return n=this.s.getUint8(this.t),i=this.s.getInt8(this.t+1),this.t+=2,[i,this.l(n)];case 200:return n=this.s.getUint16(this.t),i=this.s.getInt8(this.t+2),this.t+=3,[i,this.l(n)];case 201:return n=this.s.getUint32(this.t),i=this.s.getInt8(this.t+4),this.t+=5,[i,this.l(n)];case 202:return t=this.s.getFloat32(this.t),this.t+=4,t;case 203:return t=this.s.getFloat64(this.t),this.t+=8,t;case 204:return t=this.s.getUint8(this.t),this.t+=1,t;case 205:return t=this.s.getUint16(this.t),this.t+=2,t;case 206:return t=this.s.getUint32(this.t),this.t+=4,t;case 207:return s=this.s.getUint32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,s+r;case 208:return t=this.s.getInt8(this.t),this.t+=1,t;case 209:return t=this.s.getInt16(this.t),this.t+=2,t;case 210:return t=this.s.getInt32(this.t),this.t+=4,t;case 211:return s=this.s.getInt32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,s+r;case 212:return i=this.s.getInt8(this.t),this.t+=1,0===i?void(this.t+=1):[i,this.l(1)];case 213:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(2)];case 214:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(4)];case 215:return i=this.s.getInt8(this.t),this.t+=1,0===i?(s=this.s.getInt32(this.t)*Math.pow(2,32),r=this.s.getUint32(this.t+4),this.t+=8,new Date(s+r)):[i,this.l(8)];case 216:return i=this.s.getInt8(this.t),this.t+=1,[i,this.l(16)];case 217:return n=this.s.getUint8(this.t),this.t+=1,this.h(n);case 218:return n=this.s.getUint16(this.t),this.t+=2,this.h(n);case 219:return n=this.s.getUint32(this.t),this.t+=4,this.h(n);case 220:return n=this.s.getUint16(this.t),this.t+=2,this.g(n);case 221:return n=this.s.getUint32(this.t),this.t+=4,this.g(n);case 222:return n=this.s.getUint16(this.t),this.t+=2,this.M(n);case 223:return n=this.s.getUint32(this.t),this.t+=4,this.M(n)}throw new Error("Could not parse")};const n=function(t){var n=new e(t=t.slice(1)),i=n.v();return n.t===t.byteLength?i:null}(t);return n?.data?.[1]}};class v extends EventTarget{constructor(t){super(),this.socket=null,this.hasFired=!1,this.transportType="unknown",this.blueboatRoomId=null,this.cheat=t}getSocket(){let t=this;if(Object.isFrozen(WebSocket)){let e=setInterval((()=>{var n,i,s,r,o;let a=null===(o=null===(r=null===(s=null===(i=null===(n=null===window||void 0===window?void 0:window.stores)||void 0===n?void 0:n.network)||void 0===i?void 0:i.room)||void 0===s?void 0:s.connection)||void 0===r?void 0:r.transport)||void 0===o?void 0:o.ws;a&&(t.registerSocket(a),clearInterval(e))}),100)}else WebSocket.prototype._send=WebSocket.prototype.send,WebSocket.prototype.send=function(e){if(this.url.startsWith("ws://localhost"))return this._send(e);if(t.registerSocket(this),t.socket&&(t.socket._send(e),"blueboat"==t.transportType)){let n=m.decode(e);n.roomId&&(t.blueboatRoomId=n.roomId),n.room&&(t.blueboatRoomId=n.room),t.blueboatRoomId||t.cheat.log("Room ID: ",t.blueboatRoomId)}}}registerSocket(t){if(this.hasFired)return;this.socket=t,this.hasFired=!0,this.dispatchEvent(new CustomEvent("socket",{detail:t})),"stores"in unsafeWindow?this.transportType="colyseus":this.transportType="blueboat";let e=this;t.addEventListener("message",(t=>{let n;n="colyseus"==this.transportType?f.decode(t.data):m.decode(t.data),n&&e.dispatchEvent(new CustomEvent("recieveMessage",{detail:n}))}))}sendData(t,e){if(!this.socket)return;if(!this.blueboatRoomId&&"blueboat"==this.transportType)return this.cheat.log("Room ID not found, can't send data");let n;n="colyseus"==this.transportType?f.encode(t,e):m.encode(t,e,this.blueboatRoomId),this.socket.send(n)}}class y{constructor(){this.keys=new Set,this.binds=[],this.addListeners()}addListeners(){window.addEventListener("keydown",(t=>{this.keys.add(t.key.toLowerCase()),this.checkBinds(t)})),window.addEventListener("keyup",(t=>{this.keys.delete(t.key.toLowerCase())})),window.addEventListener("blur",(()=>{this.keys.clear()}))}checkBinds(t){var e;if(!t.repeat)for(let n of this.binds)n.keys.has(t.key.toLowerCase())&&0!=n.keys.size&&(n.exclusive&&n.keys.size!=this.keys.size||Array.from(n.keys).every((t=>this.keys.has(t)))&&(null===(e=n.callback)||void 0===e||e.call(n)))}registerBind(t){this.binds.includes(t)||this.binds.push(t)}removeBind(t){this.binds.includes(t)&&this.binds.splice(this.binds.indexOf(t),1)}clearBinds(){this.binds=[]}}class w extends EventTarget{constructor(t,e){super(),this.group=null,this.options=null,this.element=null,this.group=t,this.options=e}remove(){var t;null===(t=this.element)||void 0===t||t.remove(),this.group.elements.splice(this.group.elements.indexOf(this),1)}}class b extends w{constructor(t,e){super(t,e),this.element=document.createElement("div"),this.element.classList.add("text"),this.element.innerText=this.options.text}set text(t){this.element.innerText=t}get text(){return this.element.innerText}}class k extends w{constructor(t,e){super(t,e),this.element=document.createElement("button"),this.element.classList.add("group_opener"),this.element.innerText=this.options.text,this.element.addEventListener("click",(()=>{var t;let e=null!==(t=this.options.direction)&&void 0!==t?t:"right",n="right"==e?"left":"right";this.group.slide("out",e);let i=this.group.menu.getAnyGroup(this.options.openGroup);i&&i.slide("in",n)}))}set text(t){this.element.innerText=t}get text(){return this.element.innerText}}class _ extends w{constructor(t,e){var n,i;super(t,e),this.opacitySlider=null,this.colorPicker=null,this.preview=null;let s=document.createElement("div");s.innerHTML=`\n            <div class="text">${this.options.text}</div>\n            <div class="colorpicker_wrapper">\n                <div class="colorpicker_opacity_wrapper">\n                    <div class="text">Opacity</div>\n                    <input type="range" min="0" max="255" value="255" class="colorpicker_opacity">\n                </div>\n                <input type="color" value="#ffffff" class="colorpicker_color">\n                <div class="colorpicker_preview"></div>\n            </div>\n        `,s.classList.add("colorpicker"),this.opacitySlider=s.querySelector(".colorpicker_opacity"),this.colorPicker=s.querySelector(".colorpicker_color"),this.preview=s.querySelector(".colorpicker_preview"),this.options.bindVar?this.color=window.cheat.hud.syncedVars.get("cssVars").get(this.options.bindVar):this.options.color&&(this.color=this.options.color),this.opacitySlider.addEventListener("mousedown",(t=>{t.stopPropagation()})),null===(n=this.opacitySlider)||void 0===n||n.addEventListener("input",(()=>{this.updatePreview()})),null===(i=this.colorPicker)||void 0===i||i.addEventListener("input",(()=>{this.updatePreview()})),this.element=s,this.updatePreview()}updatePreview(){let t=this.colorPicker.value,e=parseInt(this.opacitySlider.value);this.preview.style.backgroundColor=t,this.preview.style.opacity=""+e/255,this.options.bindVar&&window.cheat.hud.updateCssVar(this.options.bindVar,this.color),this.dispatchEvent(new CustomEvent("change",{detail:this.color}))}set color(t){let[e,n]=function(t){let[e,n,i,s]=t.slice(5,-1).split(",").map((t=>parseFloat(t.trim())));return[`#${e.toString(16).padStart(2,"0")}${n.toString(16).padStart(2,"0")}${i.toString(16).padStart(2,"0")}`,s]}(t);this.colorPicker.value=e,this.opacitySlider.value=""+255*n,this.updatePreview()}get color(){let t=this.colorPicker.value,e=parseInt(this.opacitySlider.value);var n,i;return n=t,i=e/255,`rgba(${parseInt(n.slice(1,3),16)}, ${parseInt(n.slice(3,5),16)}, ${parseInt(n.slice(5,7),16)}, ${i})`}}class x{constructor(t){var e;this.capturing=!1,this.keys=new Set,this.actionState="start",this.options=t,this.keybindOpener=(new DOMParser).parseFromString('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 40"><rect width="40" height="26" x="4" y="10" rx="2.038" ry="2.234" style="fill:#000;fill-opacity:1;fill-rule:evenodd;stroke:#fff;stroke-width:8;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1;stroke-miterlimit:4;stroke-dasharray:none"/><rect width="40" height="26" x="4" y="10" rx="2.038" ry="2.234" style="fill:#000;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1"/><path d="M14 30h19M7 30h5M35 30h6M7 16h4M13 16h4M19 16h4M25 16h4M31 16h4M34 23h4M28 23h4M22 23h4M16 23h4M37 16h4M10 23h4" style="fill:none;fill-opacity:.75;fill-rule:evenodd;stroke:#fff;stroke-width:4;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/></svg>',"image/svg+xml").firstChild,this.keybindOpener.classList.add("keybind_opener"),this.keybindEditor=document.createElement("dialog"),this.keybindEditor.classList.add("keybind_editor_wrapper"),this.keybindEditor.innerHTML=`\n\t\t\t<div class="keybind_editor">\n\t\t\t\t<div class="close">x</div>\n\t\t\t\t<h1 class="keybind_title">${t.title}</h1>\n\t\t\t\t<div class="keybind_controls">\n\t\t\t\t\t<div class="keybind_display"></div>\n\t\t\t\t\t<div class="keybind_exclusive">\n\t\t\t\t\t\t<div class="text">Exclusive?</div>\n\t\t\t\t\t\t<input type="checkbox" class="exclusive" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="action">Start Capture</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;let n=null!==(e=t.exclusive)&&void 0!==e&&e,i=window.cheat.hud.syncedVars.get("keybinds").get(t.id);i?(this.keys=new Set(i.keys),n=i.exclusive):t.keys&&(this.keys=t.keys),n&&this.keybindEditor.querySelector(".exclusive").setAttribute("checked","true"),this.bind={keys:this.keys,exclusive:n,callback:t.callback},window.cheat.keybindManager.registerBind(this.bind),this.updateAction(),this.updateDisplay(),this.addEventListeners()}addEventListeners(){let t=this.keybindEditor.querySelector(".action"),e=this.keybindEditor.querySelector(".close"),n=this.keybindEditor.querySelector(".keybind_display"),i=this.keybindEditor.querySelector(".exclusive");this.keybindOpener.addEventListener("click",(()=>{this.keybindEditor.showModal()})),this.keybindEditor.addEventListener("mousedown",(e=>{e.stopPropagation(),this.capturing&&e.target!=t&&this.endCapture()})),n.addEventListener("mousedown",(t=>{t.stopPropagation(),this.beginCapture()})),e.addEventListener("click",(()=>{this.keybindEditor.close()})),t.addEventListener("click",(()=>{"Start Capture"==this.actionState?this.beginCapture():"End Capture"==this.actionState?this.endCapture():"Reset"==this.actionState&&(this.keys.clear(),this.updateDisplay(),this.updateAction())})),i.addEventListener("change",(()=>{this.bind.exclusive=i.checked,this.syncBind()}))}beginCapture(){this.capturing=!0,this.keys.clear(),this.keybindEditor.querySelector(".keybind_display").innerHTML="Press any key...",document.addEventListener("keydown",this.keybindCapture.bind(this)),this.updateAction()}keybindCapture(t){this.capturing&&(t.preventDefault(),"Escape"!==t.key&&"Enter"!==t.key?(this.keys.add(t.key.toLowerCase()),this.updateDisplay()):this.endCapture())}endCapture(){this.capturing=!1,document.removeEventListener("keydown",this.keybindCapture.bind(this)),this.updateAction(),this.syncBind()}updateDisplay(){let t=this.keybindEditor.querySelector(".keybind_display"),e=Array.from(this.keys);e=e.map((t=>" "===t?"space":t)),t.innerHTML=e.join(" + ")}updateAction(){let t=this.keybindEditor.querySelector(".action");this.capturing?this.actionState="End Capture":0==this.keys.size?this.actionState="Start Capture":this.actionState="Reset",t.innerHTML=this.actionState}attachTo(t){t.appendChild(this.keybindOpener),t.appendChild(this.keybindEditor)}syncBind(){this.options.id&&window.cheat.hud.updateKeybind(this.options.id,{keys:Array.from(this.keys),exclusive:this.bind.exclusive})}}class S extends w{constructor(t,e){var n,i;super(t,e);let s=document.createElement("div");if(s.classList.add("button_wrapper"),s.innerHTML=`\n            <button class="button">${this.options.text}</button>\n        `,this.element=s,this.button=s.querySelector("button"),this.button.addEventListener("click",(()=>{var t;this.dispatchEvent(new CustomEvent("click")),this.options.runFunction&&(null===(t=window.cheat.funcs.get(this.options.runFunction))||void 0===t||t.call(this))})),this.options.keybind){new x({title:null!==(n=e.title)&&void 0!==n?n:`Set keybind for ${this.button.innerText}`,keys:null!==(i=e.defaultKeybind)&&void 0!==i?i:new Set,exclusive:!1,callback:()=>{this.dispatchEvent(new CustomEvent("click"))}}).attachTo(s)}}set text(t){this.button.innerText=t}get text(){return this.button.innerText}}class E extends w{constructor(t,e){var n;super(t,e),this.input=null;let i=document.createElement("div");i.innerHTML=`\n            <div class="text">${this.options.text}</div>\n            <input type="text" class="textinput" placeholder="${null!==(n=this.options.placeholder)&&void 0!==n?n:""}">\n        `,i.classList.add("textinput_wrapper"),this.element=i,this.input=i.querySelector("input"),this.input.addEventListener("input",(()=>{this.dispatchEvent(new CustomEvent("input",{detail:this.text}))}))}set text(t){this.input.value=t}get text(){return this.input.value}}class M extends w{constructor(t,e){var n,i,s;super(t,e);let r=document.createElement("div");if(r.innerHTML='\n\t\t\t<button class="toggle"></button>\n\t\t',r.classList.add("toggle_wrapper"),e.keybind){let t={title:null!==(n=e.title)&&void 0!==n?n:"Set keybind for toggle",keys:null!==(i=e.defaultKeybind)&&void 0!==i?i:new Set,exclusive:!1,callback:()=>{this.toggle()}};e.keybindId&&(t.id=e.keybindId),new x(t).attachTo(r)}this.enabled=null!==(s=this.options.default)&&void 0!==s&&s,this.element=r,this.button=r.querySelector("button"),this._textEnabled=this.options.textEnabled,this._textDisabled=this.options.textDisabled,this.updateButton(),this.button.addEventListener("keydown",(t=>t.preventDefault())),this.button.addEventListener("click",(()=>{this.toggle()}))}updateButton(){this.button.innerHTML=this.enabled?this._textEnabled:this._textDisabled,this.button.classList.toggle("enabled",this.enabled)}toggle(){this.enabled=!this.enabled,this.updateButton(),this.options.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.enabled),this.dispatchEvent(new CustomEvent("change",{detail:this.enabled}))}get value(){var t;return null!==(t=this.enabled)&&void 0!==t&&t}set value(t){this.enabled=t,this.updateButton()}get textEnabled(){return this._textEnabled}set textEnabled(t){this._textEnabled=t,this.updateButton()}get textDisabled(){return this._textDisabled}set textDisabled(t){this._textDisabled=t,this.updateButton()}}class C extends w{constructor(t,e){super(t,e),this.element=document.createElement("div"),this.element.classList.add("dropdown_wrapper"),this.element.innerHTML=`\n\t\t\t<div class="text">${e.text}</div>\n\t\t\t<select class="dropdown">\n\t\t\t\t${e.options.map((t=>`<option value="${t}" ${t===e.default?"selected":""}>\n\t\t\t\t\t\t${t}\n\t\t\t\t\t</option>`)).join("")}\n\t\t\t</select>\n\t\t`,this.select=this.element.querySelector(".dropdown"),this.select.addEventListener("keydown",(t=>t.preventDefault())),this.select.addEventListener("change",(()=>{e.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.select.value),this.dispatchEvent(new CustomEvent("change",{detail:this.select.value}))}))}addOption(t){let e=document.createElement("option");e.value=t,e.innerText=t,this.select.appendChild(e)}removeOption(t){let e=this.select.querySelector(`option[value="${t}"]`);e&&this.select.removeChild(e),this.select.value===t&&(this.select.value=this.select.options[0].value)}setOptions(t){this.select.innerHTML="",t.forEach((t=>{this.addOption(t)}))}get value(){return this.select.value}set value(t){this.select.value=t}}class T extends w{constructor(t,e){var n;super(t,e);let i=document.createElement("div");i.classList.add("slider_wrapper"),i.innerHTML=`\n\t\t\t<div class = "text">${e.text}</div>\n\t\t\t<input type = "range" min = "${e.min}" max = "${e.max}" value = "${null!==(n=e.default)&&void 0!==n?n:0}" class = "slider">\n\t\t`,this.slider=i.querySelector(".slider"),this.element=i,this.slider.addEventListener("mousedown",(t=>{t.stopPropagation()})),this.slider.addEventListener("input",(()=>{this.options.runFunction&&window.cheat.funcs.get(this.options.runFunction)(this.slider.value),this.dispatchEvent(new CustomEvent("change",{detail:this.slider.value}))}))}set value(t){this.slider.value=t.toString()}get value(){return Number(this.slider.value)}}class I{constructor(t,e,n,i=!1){this.name="",this.hideTimeout=null,this.element=null,this.isRoot=!1,this.groups=[],this.parentGroup=null,this.elements=[],this.menu=null,this.menu=t,this.parentGroup=e,this.name=n,this.isRoot=i,this.init()}init(){var t,e;let n=document.createElement("div");n.classList.add("group"),this.isRoot||(n.style.display="none"),this.element=n,null===(e=null===(t=this.menu)||void 0===t?void 0:t.element)||void 0===e||e.appendChild(n),this.isRoot||this.addElement("groupopener",{text:"Back",openGroup:this.parentGroup.name,direction:"right"})}addElement(t,e){var n;let i;switch(t.toLowerCase()){case"text":i=new b(this,e);break;case"groupopener":i=new k(this,e);break;case"colorpicker":i=new _(this,e);break;case"button":i=new S(this,e);break;case"textinput":i=new E(this,e);break;case"toggle":i=new M(this,e);break;case"dropdown":i=new C(this,e);break;case"slider":i=new T(this,e);break;default:console.error(`Unknown element type: ${t}`)}return i?(null===(n=this.element)||void 0===n||n.appendChild(i.element),i):null}slide(t,e){this.hideTimeout&&clearTimeout(this.hideTimeout),this.element.style.animation=`slide_${t}_${e} both 0.5s`,"in"==t?this.element.style.display="flex":"out"==t&&(this.hideTimeout=setTimeout((()=>this.element.style.display="none"),500))}createGroup(t){let e=this.menu.getAnyGroup(t);if(e)return e;let n=new I(this.menu,this,t);return this.groups.push(n),this.menu.groups.push(n),this.addElement("groupopener",{text:t,openGroup:t,direction:"left"}),n}group(t){for(let e=0;e<this.groups.length;e++)if(this.groups[e].name==t)return this.groups[e];return null}remove(){var t,e;null===(t=this.element)||void 0===t||t.remove(),null===(e=this.parentGroup)||void 0===e||e.groups.splice(this.parentGroup.groups.indexOf(this),1),this.menu.groups.splice(this.menu.groups.indexOf(this),1)}clearElements(){this.elements=[],this.element&&(this.element.innerHTML="")}loadFromObject(t){const e=()=>{if(t.groups)for(let e of t.groups){this.createGroup(e.name).loadFromObject(e)}},n=()=>{if(t.elements)for(let e of t.elements)this.addElement(e.type,e.options)};"elementsFirst"==t.order?(n(),e()):(e(),n())}}class L{constructor(t){this.menu=null,this.element=null,this.menu=t,this.init()}init(){var t,e;let n=document.createElement("div");n.classList.add("menu_controls"),n.innerHTML=this.menu.name;let i=document.createElement("div");i.classList.add("menu_minimizer"),this.element=n,this.element.appendChild(i),null===(e=null===(t=this.menu)||void 0===t?void 0:t.element)||void 0===e||e.appendChild(n),this.updateMinimizer(),i.addEventListener("click",(()=>{var t;null===(t=this.menu)||void 0===t||t.minimize(),this.updateMinimizer()}))}updateMinimizer(){var t;if(!this.element)return;let e=this.element.querySelector(".menu_minimizer");e&&(e.innerHTML=(null===(t=this.menu)||void 0===t?void 0:t.minimized)?"+":"-")}}class A{constructor(t,e,n){this.hud=null,this.element=null,this.rootGroup=null,this.name="",this.groups=[],this.minimized=!1,this.transform={top:0,left:0,width:300,height:200,minimized:!1},this.hud=t,this.name=e,n&&(this.transform=n),this.init()}applyTransform(t){var e;this.element&&(t.height<50&&(t.height=50),t.width<50&&(t.width=50),this.element.style.top=`${t.top}px`,this.element.style.left=`${t.left}px`,this.element.style.width=`${t.width}px`,this.element.style.height=`${t.height}px`,this.minimize(null!==(e=t.minimized)&&void 0!==e&&e))}init(){var t;let e=document.createElement("div");e.classList.add("menu"),this.element=e,null===(t=this.hud)||void 0===t||t.element.appendChild(e),this.applyTransform(this.transform),new L(this);let n=new I(this,null,"root",!0);this.rootGroup=n,this.groups.push(n),n.element&&this.element.appendChild(n.element),this.addListeners()}addListeners(){if(!this.element)return;let t=!1,e={x:0,y:0},n=0;this.element.addEventListener("mousedown",(i=>{t=!0,e.x=i.clientX,e.y=i.clientY,n=0})),window.addEventListener("mouseup",(()=>{t=!1})),new ResizeObserver((e=>{0!=e[0].contentRect.width&&0!=e[0].contentRect.height&&(t=!1,this.transform.width=e[0].contentRect.width,this.minimized||(this.transform.height=e[0].contentRect.height),this.syncTransform())})).observe(this.element),window.addEventListener("mousemove",(i=>{if(!t)return;if(n+=Math.abs(i.clientX-e.x)+Math.abs(i.clientY-e.y),n<10)return;let s=i.clientX-e.x,r=i.clientY-e.y;this.element.style.left=`${this.element.offsetLeft+s}px`,this.element.style.top=`${this.element.offsetTop+r}px`,this.transform.top=this.element.offsetTop,this.transform.left=this.element.offsetLeft,this.syncTransform(),this.element.offsetLeft<0&&(this.element.style.left="0px"),this.element.offsetTop<0&&(this.element.style.top="0px"),this.element.offsetLeft+this.element.offsetWidth>window.innerWidth&&(this.element.style.left=window.innerWidth-this.element.offsetWidth+"px"),this.element.offsetTop+this.element.offsetHeight>window.innerHeight&&(this.element.style.top=window.innerHeight-this.element.offsetHeight+"px"),e.x=i.clientX,e.y=i.clientY}))}syncTransform(){this.hud.updateMenuTransform(this.name,this.transform)}createGroup(t){return this.rootGroup.createGroup(t)}group(t){return this.rootGroup.group(t)}addElement(t,e){return this.rootGroup.addElement(t,e)}getAnyGroup(t){for(let e of this.groups)if(e.name==t)return e;return null}remove(){var t;null===(t=this.element)||void 0===t||t.remove(),this.hud.menus.splice(this.hud.menus.indexOf(this),1)}minimize(t=null){this.minimized=null==t?!this.minimized:t,this.element.classList.toggle("minimized",this.minimized),this.transform.minimized=this.minimized,this.syncTransform()}loadFromObject(t){this.rootGroup.loadFromObject(t)}}const U=new Map([["menu-bg-color","rgba(0, 0, 0, 0.5)"],["menu-border-color","rgba(0, 0, 0, 0)"],["text-color","rgba(255, 255, 255, 1)"],["button-bg-color","rgba(0, 0, 0, 0.5)"],["button-border-color","rgba(255, 255, 255, 1)"],["menu-controls-bg-color","rgba(0, 0, 255, 0.5)"],["menu-controls-text-color","rgba(255, 255, 255, 1)"],["textinput-border-color","rgba(255, 255, 255, 1)"],["textinput-bg-color","rgba(0, 0, 0, 0.5)"],["toggle-bg-color","rgba(0, 0, 0, 0.5)"],["toggle-border-color","rgba(255, 255, 255, 1)"],["dropdown-bg-color","rgba(0, 0, 0, 0.5)"],["dropdown-border-color","rgba(255, 255, 255, 1)"],["keybind-editor-bg-color","rgba(0, 0, 0, 0.75)"],["keybind-editor-border-color","rgba(255, 255, 255, 1)"]]),P=new Map([["HUD Customization",{top:10,left:10,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}],["Devtools",{top:window.innerHeight/2+10,left:10,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!0}],["General Cheats",{top:10,left:window.innerWidth/3+20,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}],["Cheats for gamemodes",{top:10,left:window.innerWidth/3*2+30,width:Math.min(window.innerWidth/4,350),height:window.innerHeight/2,minimized:!1}]]),B=new Map([]),D={menus:[{name:"HUD Customization",groups:[{name:"General",order:"elementsFirst",elements:[{type:"colorpicker",options:{text:"Text Color",bindVar:"text-color"}}],groups:[{name:"Menu Appearance",elements:[{type:"colorpicker",options:{text:"Menu Background Color",bindVar:"menu-bg-color"}},{type:"colorpicker",options:{text:"Menu Border Color",bindVar:"menu-border-color"}}]},{name:"Menu Controls Appearance",elements:[{type:"colorpicker",options:{text:"Menu Controls Background Color",bindVar:"menu-controls-bg-color"}},{type:"colorpicker",options:{text:"Menu Controls Text Color",bindVar:"menu-controls-text-color"}}]},{name:"Keybind Editor Appearance",elements:[{type:"colorpicker",options:{text:"Keybind Editor Background Color",bindVar:"keybind-editor-bg-color"}},{type:"colorpicker",options:{text:"Keybind Editor Border Color",bindVar:"keybind-editor-border-color"}}]}]},{name:"Elements",groups:[{name:"Buttons",elements:[{type:"colorpicker",options:{text:"Button Background Color",bindVar:"button-bg-color"}},{type:"colorpicker",options:{text:"Button Border Color",bindVar:"button-border-color"}}]},{name:"Text Inputs",elements:[{type:"colorpicker",options:{text:"Text Input Background Color",bindVar:"textinput-bg-color"}},{type:"colorpicker",options:{text:"Text Input Border Color",bindVar:"textinput-border-color"}}]},{name:"Toggles",elements:[{type:"colorpicker",options:{text:"Toggle Background Color",bindVar:"toggle-bg-color"}},{type:"colorpicker",options:{text:"Toggle Border Color",bindVar:"toggle-border-color"}}]},{name:"Dropdowns",elements:[{type:"colorpicker",options:{text:"Dropdown Background Color",bindVar:"dropdown-bg-color"}},{type:"colorpicker",options:{text:"Dropdown Border Color",bindVar:"dropdown-border-color"}}]}]}],elements:[{type:"button",options:{text:"Reset settings",runFunction:"resetSettings"}}]}]};class O{constructor(){this.canvas=document.createElement("canvas"),this.canvas.classList.add("gc_overlay_canvas"),this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,window.addEventListener("resize",(()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight}))}get context(){return this.canvas.getContext("2d")}}class V{constructor(t){this.element=null,this.menus=[],this.cssVarsSheet=null,window.cheat.hud=this,this.syncedVars=new Map,this.cheat=t,this.cheat.funcs.set("resetSettings",this.resetSettings.bind(this)),this.loadSyncedVar("cssVars",U),this.loadSyncedVar("menuTransforms",P),this.loadSyncedVar("keybinds",B),this.updateCssVars(),this.init(),this.loadFromObject(D),this.addToggle()}resetSettings(){confirm("Setting updates will only take place after you reload the page, are you sure you want to reset settings?")&&(GM_deleteValue("cssVars"),GM_deleteValue("menuTransforms"),GM_deleteValue("keybinds"))}addToggle(){this.cheat.keybindManager.registerBind({keys:new Set(["\\"]),exclusive:!1,callback:()=>{this.element&&(this.element.style.display="none"==this.element.style.display?"":"none")}})}createMenu(t){var e;let n=this.menu(t);if(n)return n;let i=null===(e=this.syncedVars.get("menuTransforms"))||void 0===e?void 0:e.get(t),s=new A(this,t,i);return this.menus.push(s),s}menu(t){for(let e=0;e<this.menus.length;e++)if(this.menus[e].name==t)return this.menus[e];return null}loadSyncedVar(t,e){let n=GM_getValue(t,"{}"),i=JSON.parse(n);for(let[t,n]of e)i[t]||(i[t]=n);this.syncedVars.set(t,new Map(Object.entries(i)))}updateCssVar(t,e){var n,i;null===(n=this.syncedVars.get("cssVars"))||void 0===n||n.set(t,e),this.updateCssVars();let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("cssVars"))&&void 0!==i?i:[]));GM_setValue("cssVars",s)}updateMenuTransform(t,e){var n,i;null===(n=this.syncedVars.get("menuTransforms"))||void 0===n||n.set(t,e);let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("menuTransforms"))&&void 0!==i?i:[]));GM_setValue("menuTransforms",s)}updateKeybind(t,e){var n,i;console.log(t,e),null===(n=this.syncedVars.get("keybinds"))||void 0===n||n.set(t,e);let s=JSON.stringify(Object.fromEntries(null!==(i=this.syncedVars.get("keybinds"))&&void 0!==i?i:[]));GM_setValue("keybinds",s)}updateCssVars(){var t;this.cssVarsSheet||(this.cssVarsSheet=new CSSStyleSheet,document.adoptedStyleSheets=[...document.adoptedStyleSheets,this.cssVarsSheet]);let e=":root {\n";for(let[n,i]of null!==(t=this.syncedVars.get("cssVars"))&&void 0!==t?t:[])e+=`\t--${n}: ${i};\n`;e+="}",this.cssVarsSheet.replaceSync(e)}init(){let t=new CSSStyleSheet;t.replaceSync("#gc_hud {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    z-index: 999999999999;\r\n    pointer-events: none;\r\n    color: var(--text-color);\r\n}\r\n\r\n#gc_hud .menu_controls {\r\n    width: 100%;\r\n    height: 20px;\r\n    background-color: var(--menu-controls-bg-color);\r\n    color: var(--menu-controls-text-color);\r\n    border-radius: 5px 5px 0px 0px;\r\n    text-align: center;\r\n    position: relative;\r\n}\r\n\r\n#gc_hud .menu_minimizer {\r\n    margin-left: 20px;\r\n    margin-right: 20px;\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    user-select: none;\r\n}\r\n\r\n#gc_hud .menu {\r\n    pointer-events: auto;\r\n    position: absolute;\r\n    background-color: var(--menu-bg-color);\r\n    display: inline-block;\r\n    border-radius: 5px;\r\n    overflow-x: hidden;\r\n    overflow-y: hidden;\r\n    resize: both;\r\n    width: 300px;\r\n    height: 200px;\r\n    outline: 3px solid var(--menu-border-color);\r\n}\r\n\r\n#gc_hud .menu.minimized {\r\n    height: 20px !important;\r\n    overflow-y: hidden;\r\n    resize: horizontal;\r\n}\r\n\r\n#gc_hud .group {\r\n    margin: 0px;\r\n    padding: 0px;\r\n    width: 100%;\r\n    /* allocate some space at the top and bottom */\r\n    height: calc(100% - 40px); \r\n    position: absolute;\r\n    top: 20px;\r\n    left: 0;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: flex-start;\r\n    align-items: center;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n}\r\n\r\n#gc_hud .button, #gc_hud .group_opener {\r\n    background-color: var(--button-bg-color);\r\n    border: 1px solid var(--button-border-color);\r\n}\r\n\r\n#gc_hud .toggle {\r\n    background-color: var(--toggle-bg-color);\r\n    border: 1px solid var(--toggle-border-color);\r\n}\r\n\r\n#gc_hud .button, #gc_hud .toggle, #gc_hud .group_opener {\r\n    border-radius: 5px;\r\n    padding: 5px;\r\n    margin: 5px;\r\n    cursor: pointer;\r\n    width: 90%;\r\n    transition: transform 0.2s ease-in-out;\r\n}\r\n\r\n/* make it bounce smaller when clicked */\r\n#gc_hud .button:active, #gc_hud .toggle:active, #gc_hud .group_opener:active {\r\n    transform: scale(0.93);\r\n}\r\n\r\n#gc_hud .colorpicker {\r\n    width: 100%;\r\n}\r\n\r\n#gc_hud .colorpicker_wrapper {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .colorpicker_opacity_wrapper {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .colorpicker_preview {\r\n    width: 50px;\r\n    height: 50px;\r\n    border-radius: 5px;\r\n    opacity: 1;\r\n}\r\n\r\n#gc_hud .text {\r\n    text-align: center;\r\n    width: 100%;\r\n}\r\n\r\n#gc_hud .textinput_wrapper, #gc_hud .dropdown_wrapper, #gc_hud .slider_wrapper {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .textinput {\r\n    width: 90%;\r\n    border-radius: 5px;\r\n    border: 1px solid var(--textinput-border-color);\r\n    background-color: var(--textinput-bg-color);\r\n    color: var(--text-color);\r\n    padding: 5px;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .dropdown {\r\n    width: 90%;\r\n    border-radius: 5px;\r\n    border: 1px solid var(--dropdown-border-color);\r\n    background-color: var(--dropdown-bg-color);\r\n    color: var(--text-color);\r\n    padding: 5px;\r\n    margin: 5px;\r\n}\r\n\r\n#gc_hud .toggle_wrapper, #gc_hud .button_wrapper {\r\n    width: 90%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    padding: 0px;\r\n}\r\n\r\n#gc_hud .toggle, #gc_hud .button {\r\n    /* make it take up as much space as possible */\r\n    width: 100%;\r\n    margin: 0px;\r\n}\r\n\r\n#gc_hud .keybind_opener {\r\n    width: 30px;\r\n    height: 30px;\r\n    font-size: 30px;\r\n    margin-left: 10px;\r\n}\r\n\r\n#gc_hud .keybind_editor_wrapper {\r\n    background-color: var(--keybind-editor-bg-color);\r\n    border: 3px solid var(--keybind-editor-border-color);\r\n    border-radius: 8px;\r\n}\r\n\r\n#gc_hud .keybind_editor {\r\n    width: 50vw;\r\n    height: 50vh;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n    color: var(--text-color);\r\n}\r\n\r\n#gc_hud .close {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    width: 20px;\r\n    height: 20px;\r\n    font-size: 20px;\r\n    cursor: pointer;\r\n    user-select: none;\r\n}\r\n\r\n#gc_hud .keybind_title {\r\n    font-size: 40px;\r\n    text-align: center;\r\n}\r\n\r\n#gc_hud .keybind_controls {\r\n    width: 100%;\r\n    display: flex;\r\n    flex-direction: row;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n}\r\n\r\n#gc_hud .keybind_display {\r\n    border: 3px solid white;\r\n    min-width: 300px;\r\n    border-radius: 5px;\r\n    height: 50px;\r\n    text-align: center;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    cursor: pointer;\r\n}\r\n\r\n#gc_hud .keybind_exclusive {\r\n    display: flex;\r\n}\r\n\r\n#gc_hud .keybind_exclusive .text {\r\n    margin-right: 10px;\r\n}\r\n\r\n#gc_hud .keybind_editor .action {\r\n    cursor: pointer;\r\n}\r\n\r\n#gc_hud .slider {\r\n    width: 90%;\r\n    margin: 5px;\r\n}\r\n\r\n.gc_overlay_canvas {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    z-index: 9999;\r\n    pointer-events: none;\r\n}\r\n\r\n@keyframes slide_out_left {\r\n    0% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(-100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n}\r\n\r\n@keyframes slide_out_right {\r\n    0% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n}\r\n\r\n@keyframes slide_in_left {\r\n    0% {\r\n        transform: translateX(-100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n}\r\n\r\n@keyframes slide_in_right {\r\n    0% {\r\n        transform: translateX(100%);\r\n        opacity: 0;\r\n        pointer-events: none;\r\n    }\r\n\r\n    100% {\r\n        transform: translateX(0);\r\n        opacity: 1;\r\n        pointer-events: all;\r\n    }\r\n}\r\n\r\n@keyframes idle {}"),document.adoptedStyleSheets=[...document.adoptedStyleSheets,t];let e=document.createElement("div");e.id="gc_hud",this.element=e,document.addEventListener("DOMContentLoaded",(()=>{document.body.appendChild(e)})),this.updateCssVars()}loadFromObject(t){for(let e of t.menus){this.createMenu(e.name).loadFromObject(e)}}createOverlayCanvas(){var t;let e=new O;return null===(t=document.body)||void 0===t||t.appendChild(e.canvas),e}}const G={menus:[{name:"Devtools",elements:[{type:"toggle",options:{textEnabled:"Stop logging incoming messages",textDisabled:"Log incoming messages",default:!1,runFunction:"logIncomingMessages"}}]}]};class W{constructor(){this.name="Gimkit Cheat Devtools",this.hudAddition=G,this.loggingIncomingMessages=!1,this.funcs=new Map([["logIncomingMessages",t=>{this.loggingIncomingMessages=t}]])}init(t){t.socketHandler.addEventListener("recieveMessage",(e=>{this.loggingIncomingMessages&&t.log("Incoming message",e.detail)}))}}const F={menus:[{name:"General Cheats",elements:[{type:"toggle",options:{textEnabled:"Stop auto answering",textDisabled:"Auto answer",default:!1,runFunction:"setAutoAnswer",keybind:!0,keybindId:"autoAnswer"}}]}]};class z{constructor(){this.name="Autoanswer",this.hudAddition=F,this.autoAnswering=!1,this.funcs=new Map([["setAutoAnswer",t=>{this.autoAnswering=t}]]),this.currentQuestionId="",this.answerDeviceId="",this.questions=[],this.questionIdList=[],this.currentQuestionIndex=0}init(t){t.socketHandler.addEventListener("recieveMessage",(e=>{var n,i,s,r,o;if("colyseus"==t.socketHandler.transportType){if(!(null===(n=e.detail)||void 0===n?void 0:n.changes))return;let t=function(t){let e=[];for(let n of t.changes){let i={},s=n[1].map((e=>t.values[e]));for(let t=0;t<s.length;t++)i[s[t]]=n[2][t];e.push({id:n[0],data:i})}return e}(e.detail);for(let e of t){for(let[t,n]of Object.entries(e.data))"GLOBAL_questions"==t&&(this.questions=JSON.parse(n),this.answerDeviceId=e.id);for(let[t,n]of Object.entries(e.data))t.includes("currentQuestionId")&&t.includes(null===(r=null===(s=null===(i=unsafeWindow.stores)||void 0===i?void 0:i.phaser)||void 0===s?void 0:s.mainCharacter)||void 0===r?void 0:r.id)&&(this.currentQuestionId=n)}}else{if("STATE_UPDATE"!=(null===(o=e.detail)||void 0===o?void 0:o.key))return;switch(e.detail.data.type){case"GAME_QUESTIONS":this.questions=e.detail.data.value;break;case"PLAYER_QUESTION_LIST":this.questionIdList=e.detail.data.value.questionList,this.currentQuestionIndex=e.detail.data.value.questionIndex;break;case"PLAYER_QUESTION_LIST_INDEX":this.currentQuestionIndex=e.detail.data.value}}})),setInterval((()=>{var e;if(this.autoAnswering)if("colyseus"==t.socketHandler.transportType){if(""==this.currentQuestionId)return;let n=null===(e=this.questions)||void 0===e?void 0:e.find((t=>t._id==this.currentQuestionId));if(!n)return;let i=n.answers.find((t=>t.correct))._id,s={key:"answered",deviceId:this.answerDeviceId,data:{answer:i}};t.socketHandler.sendData("MESSAGE_FOR_DEVICE",s)}else{let e=this.questionIdList[this.currentQuestionIndex],n=this.questions.find((t=>t._id==e)).answers.find((t=>t.correct))._id;t.socketHandler.sendData("QUESTION_ANSWERED",{answer:n,questionId:e})}}),1e3)}}let H=["Unchanged","default_browngreen","default_cyan","default_darkblue","default_darkgreen","default_darkpurple","default_gray","default_grayblue","default_graybrown","default_hotpink","default_lightbrown","default_lightgreen","default_lightpink","default_lightpurple","default_lightyellow","default_lime","default_maroon","default_orange","default_pink","default_red","default_yellow","sunny","glassHalfFull","stripeDoubleGreen","sprinklesRed","dayOne","vortexAgent","echoAgent","grayGradient","mustache","clown","redNinja","redDeliciousApple","polkaDotBlueAndYellow","fadedBlueGradient","whiteAndBlueVerticalStripes","volcanoCracks","pinkPaste","yellowCracksPurple","glyphsYellowBrown","camoBlue","glyphsOrangeBlue","purplePaste","mustacheBrown","mustachePink","polkaDotWhiteAndRed","camoTan","camoGreen","stripeDoublePurple","stripeDoubleRed","stripeDoubleYellow","sprinklesChocolate","coolRedBlueGradient","mountainAndSun","redDinoCostume","pencilPack","corn","luchador","fox","burger","galaxy","cellBlue","cellGold","rockyWest","puzzleRedGreen","puzzleOrangeBlue","puzzleGrayWhite","puzzleGreenBlue","puzzleYellowPurple","pumpkin","ghostCostume","mummy","fifthBirthday","pumpkinPie","feast","frostBuddy","festiveOnesieTan","festiveOnesieRed","festiveOnesieGreen","festiveOnesieBlue","hotChocolate","snowglobe","polkaDotFestive","polkaDotFestiveReverse","mustacheSanta","firework","gift","snowman","detective","yinYang","astroHelmet","hamster","pirate","rockstar","circuitGray","circuitBlue","circuitGreen","roses","heart","zebra","constellationBlackWhite","constellationBlackGreen","constellationPurpleYellow","constellationPinkGreen","constellationYellowPink","squiggles","frozenMummy","leprechaun","evilPlantGreen","evilPlantPink","fisher","rainbowWave","sketch","sketchBlue","bananaSplit","eightBit","gamerGreen","gamerPink","gamerPurple","gamerYellow","graduate","graduateBlue","arcticFox"],j=["None","origin_token"];H=H.sort(),j=j.sort();const R={menus:[{name:"General Cheats",groups:[{name:"Cosmetic Picker",elements:[{type:"text",options:{text:"Select cosmetics to apply to your character. These changes are only visible to you."}},{type:"dropdown",options:{text:"Selected Skin",options:H,runFunction:"setSkin",default:"Unchanged"}},{type:"dropdown",options:{text:"Selected Trail",options:j,runFunction:"setTrail",default:"None"}}]}]}]};class ${constructor(){this.name="Cosmetic Picker",this.hudAddition=R,this.funcs=new Map([["setSkin",t=>{this.setSkin(t)}],["setTrail",t=>{this.setTrail(t)}]]),this.skinWaiting=!1,this.trailWaiting=!1}setSkin(t){var e,n,i,s,r,o;if("Unchanged"==t)return;if(!("stores"in unsafeWindow)){if(this.skinWaiting)return;let e=setInterval((()=>{"stores"in unsafeWindow&&(this.hasSkinApplied(t)&&clearInterval(e),this.setSkin(t))}),100);return void(this.skinWaiting=!0)}let a=unsafeWindow.stores.phaser,l=null===(e=a.mainCharacter)||void 0===e?void 0:e.id;if(!l)return;let h=`character_${t}`;null===(o=null===(r=null===(s=null===(i=null===(n=a.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(l))||void 0===r?void 0:r.skin)||void 0===o||o.updateSkin(h)}hasSkinApplied(t){var e,n,i,s,r;let o=unsafeWindow.stores.phaser,a=null===(e=o.mainCharacter)||void 0===e?void 0:e.id;if(!a)return;let l=`character_${t}`;return(null===(r=null===(s=null===(i=null===(n=o.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(a))||void 0===r?void 0:r.skin.skinId)==l}setTrail(t){var e,n,i,s,r,o;if(!("stores"in unsafeWindow)){if(this.trailWaiting)return;let e=setInterval((()=>{"stores"in unsafeWindow&&(this.hasSkinApplied(t)&&clearInterval(e),this.setTrail(t))}),100);return void(this.trailWaiting=!0)}let a=unsafeWindow.stores.phaser,l=null===(e=a.mainCharacter)||void 0===e?void 0:e.id;if(!l)return;"None"==t&&(t="");let h=`trail_${t}`;null===(o=null===(r=null===(s=null===(i=null===(n=a.scene)||void 0===n?void 0:n.characterManager)||void 0===i?void 0:i.characters)||void 0===s?void 0:s.get(l))||void 0===r?void 0:r.characterTrail)||void 0===o||o.updateAppearance(h)}}const q={menus:[{name:"General Cheats",groups:[{name:"Player Highlighter",elements:[{type:"toggle",options:{textEnabled:"Stop Highlighting Teammates",textDisabled:"Highlight Teammates",runFunction:"highlightTeammates",keybind:!0,keybindId:"highlightTeammates"}},{type:"toggle",options:{textEnabled:"Stop Highlighting Enemies",textDisabled:"Highlight Enemies",runFunction:"highlightEnemies",keybind:!0,keybindId:"highlightEnemies"}},{type:"slider",options:{text:"Arrow Distance",min:20,max:750,default:200,runFunction:"setArrowDistance"}}]}]}]};class N{constructor(){this.name="Player Highlighter",this.hudAddition=q,this.funcs=new Map([["highlightTeammates",t=>{this.highlightingTeammates=t}],["highlightEnemies",t=>{this.highlightingEnemies=t}],["setArrowDistance",t=>{this.arrowDistance=t}]]),this.highlightingTeammates=!1,this.highlightingEnemies=!1,this.ctx=null,this.canvas=null,this.arrowDistance=200}init(t){setInterval((()=>{var e,n;(null===(n=null===(e=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===e?void 0:e.phaser)||void 0===n?void 0:n.scene)&&(null==this.canvas&&(this.canvas=t.hud.createOverlayCanvas(),this.ctx=this.canvas.context),this.render())}),100)}render(){var t,e,n,i,s,r,o,a,l,h,d;null===(t=this.ctx)||void 0===t||t.clearRect(0,0,null!==(n=null===(e=this.canvas)||void 0===e?void 0:e.canvas.width)&&void 0!==n?n:1920,null!==(s=null===(i=this.canvas)||void 0===i?void 0:i.canvas.height)&&void 0!==s?s:1080);let u=unsafeWindow.stores.phaser,c=u.scene.characterManager.characters,p=u.mainCharacter;for(let[t,e]of c){if(t==p.id)continue;let n=e.teamId!=p.teamId;if(n&&!this.highlightingEnemies)continue;if(!n&&!this.highlightingTeammates)continue;this.ctx.strokeStyle=n?"red":"green",this.ctx.lineWidth=5;let i=Math.atan2(e.body.y-p.body.y,e.body.x-p.body.x),s=Math.sqrt(Math.pow(e.body.x-p.body.x,2)+Math.pow(e.body.y-p.body.y,2)),u=Math.min(s,this.arrowDistance),c={x:Math.cos(i)*u+this.canvas.canvas.width/2,y:Math.sin(i)*u+this.canvas.canvas.height/2},f=i-Math.PI/4*3,g=i+Math.PI/4*3;null===(r=this.ctx)||void 0===r||r.beginPath(),null===(o=this.ctx)||void 0===o||o.moveTo(c.x,c.y),null===(a=this.ctx)||void 0===a||a.lineTo(50*Math.cos(f)+c.x,50*Math.sin(f)+c.y),null===(l=this.ctx)||void 0===l||l.moveTo(c.x,c.y),null===(h=this.ctx)||void 0===h||h.lineTo(50*Math.cos(g)+c.x,50*Math.sin(g)+c.y),null===(d=this.ctx)||void 0===d||d.stroke(),this.ctx.fillStyle="black",this.ctx.font="20px Verdana",this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(`${e.nametag.name} (${Math.round(s)})`,c.x,c.y)}}}class Q{constructor(){this.name="Cosmetic Picker",this.freecamming=!1,this.freeCamPos={x:0,y:0},this.toggleFreecam=null,this.spectateMenu=null}init(t){let e=t.hud.createMenu("General Cheats").createGroup("Freecam"),n=e.addElement("toggle",{textEnabled:"Stop Freecamming",textDisabled:"Unbind Camera",keybind:!0,keybindId:"toggleFreecam"});n.addEventListener("change",(t=>{this.camHelper?this.enableFreecam(t.detail):n.value=!1}));let i=e.addElement("dropdown",{text:"Spectate Player",options:["None"]});i.addEventListener("change",(t=>{this.spectatePlayer(t.detail)})),this.toggleFreecam=n,this.spectateMenu=i;let s=setInterval((()=>{var t,e,n;(null===(n=null===(e=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===e?void 0:e.scene)||void 0===n?void 0:n.cameraHelper)&&(this.camHelper=unsafeWindow.stores.phaser.scene.cameraHelper,setInterval((()=>{this.update()}),1e3/60),clearInterval(s))}),100)}enableFreecam(t){let e=unsafeWindow.stores.phaser,n=e.scene.cameras.cameras[0];if(t)this.camHelper.stopFollow(),this.freeCamPos.x=n.midPoint.x,this.freeCamPos.y=n.midPoint.y;else{let t=e.scene.characterManager.characters.get(e.mainCharacter.id).body;this.camHelper.startFollowingObject({object:t})}this.freecamming=t}spectatePlayer(t){if("None"==t)return void this.enableFreecam(!1);this.toggleFreecam.value=!0;let e=unsafeWindow.stores.phaser.scene.characterManager.characters;for(let[n,i]of e)if(i.nametag.name==t){this.camHelper.startFollowingObject({object:i.body});break}}update(){if(this.updateSpectatablePlayers(),!this.freecamming)return;let t=window.cheat.keybindManager.keys;t.has("u")&&(this.freeCamPos.y-=20),t.has("h")&&(this.freeCamPos.x-=20),t.has("j")&&(this.freeCamPos.y+=20),t.has("k")&&(this.freeCamPos.x+=20),this.camHelper.goTo(this.freeCamPos)}updateSpectatablePlayers(){var t;let e=unsafeWindow.stores.phaser,n=e.scene.characterManager.characters,i=["None"];for(let[t,s]of n)t!=e.mainCharacter.id&&i.push(s.nametag.name);null===(t=this.spectateMenu)||void 0===t||t.setOptions(i)}}var Y;!function(t){t.Insurance="insurance",t["Money Per Question"]="moneyPerQuestion",t.Multiplier="multiplier",t["Streak Bonus"]="streakBonus"}(Y||(Y={}));const X={menus:[{name:"Cheats for gamemodes",groups:[{name:"Classic",elements:[{type:"toggle",options:{textEnabled:"Stop Auto Purchasing",textDisabled:"Start Auto Purchasing",default:!1,runFunction:"setAutoPurchasingClassic",keybind:!0,keybindId:"autoPurchasingClassic"}}]}]}]};class J{constructor(){this.name="Classic Script",this.money=0,this.upgradeLevels={insurance:1,moneyPerQuestion:1,multiplier:1,streakBonus:1},this.hudAddition=X,this.autoPurchasing=!1,this.funcs=new Map([["setAutoPurchasingClassic",t=>{this.autoPurchasing=t,this.autoPurchasing&&this.checkAutoBuy()}]]),this.upgradesToGet=[["Streak Bonus",2,20],["Money Per Question",3,100],["Streak Bonus",3,200],["Multiplier",3,300],["Streak Bonus",4,2e3],["Multiplier",4,2e3],["Money Per Question",5,1e4],["Streak Bonus",5,2e4],["Multiplier",5,12e3],["Money Per Question",6,75e3],["Multiplier",6,85e3],["Streak Bonus",6,2e5],["Streak Bonus",7,2e6],["Streak Bonus",8,2e7],["Multiplier",7,7e5],["Money Per Question",9,1e7],["Multiplier",8,65e5],["Streak Bonus",9,2e8],["Multiplier",9,65e6],["Streak Bonus",10,2e9],["Money Per Question",10,1e8],["Multiplier",10,1e9]]}init(t){this.cheat=t,this.cheat.socketHandler.addEventListener("recieveMessage",(t=>{var e,n;if("blueboat"==this.cheat.socketHandler.transportType){if("UPGRADE_LEVELS"==(null===(e=t.detail.data)||void 0===e?void 0:e.type)){this.upgradeLevels=t.detail.data.value;for(let t=0;t<this.upgradesToGet.length;t++){let e=this.upgradesToGet[t];this.upgradeLevels[Y[e[0]]]>=e[1]&&(this.upgradesToGet.splice(t,1),t--)}}"BALANCE"==(null===(n=t.detail.data)||void 0===n?void 0:n.type)&&(this.money=t.detail.data.value,this.checkAutoBuy())}}))}checkAutoBuy(){if(!this.autoPurchasing)return;let t=this.upgradesToGet[0];t&&this.money>=t[2]&&this.purchaseUpgrade(t[0],t[1])}purchaseUpgrade(t,e){this.cheat.log("Purchasing upgrade",t,e),this.cheat.socketHandler.sendData("UPGRADE_PURCHASED",{upgradeName:t,level:e})}}const K={menus:[{name:"Cheats for gamemodes",groups:[{name:"Super Rich Mode",elements:[{type:"toggle",options:{textEnabled:"Stop Auto Purchasing",textDisabled:"Start Auto Purchasing",default:!1,runFunction:"setAutoPurchasingRichMode",keybind:!0,keybindId:"autoPurchasingRichMode"}}]}]}]};class Z extends J{constructor(){super(...arguments),this.name="Rich Mode Script",this.hudAddition=K,this.funcs=new Map([["setAutoPurchasingRichMode",t=>{this.autoPurchasing=t,this.autoPurchasing&&this.checkAutoBuy()}]]),this.upgradesToGet=[["Streak Bonus",2,1e4],["Money Per Question",3,5e3],["Streak Bonus",3,1e5],["Multiplier",3,15e4],["Streak Bonus",4,1e6],["Multiplier",4,1e6],["Money Per Question",5,5e6],["Streak Bonus",5,1e7],["Multiplier",5,6e6],["Money Per Question",6,375e5],["Multiplier",6,425e5],["Streak Bonus",6,1e8],["Streak Bonus",7,1e9],["Streak Bonus",8,1e10],["Multiplier",7,35e7],["Money Per Question",9,5e9],["Multiplier",8,325e7],["Streak Bonus",9,1e11],["Multiplier",9,325e8],["Streak Bonus",10,1e12],["Money Per Question",10,5e10],["Multiplier",10,5e11]]}}class tt{constructor(){this.name="Trust No One Script",this.people=[]}init(t){this.cheat=t;let e=t.hud.createMenu("Cheats for gamemodes").createGroup("Trust No One").addElement("text",{text:"Imposters: Waiting... (only works if you don't join mid-game)"});t.socketHandler.addEventListener("recieveMessage",(t=>{if("blueboat"==this.cheat.socketHandler.transportType&&"IMPOSTER_MODE_PEOPLE"==t.detail.key){this.people=t.detail.data;let n=this.people.filter((t=>"imposter"==t.role));e.text=`Imposter(s): ${n.map((t=>t.name)).join(", ")}`}}))}}const et={menus:[{name:"General Cheats",elements:[{type:"toggle",options:{textEnabled:"Stop instant use",textDisabled:"Instant use",default:!0,runFunction:"setInstantUse",keybind:!0,keybindId:"instantUse"}}]}]};class nt{constructor(){this.name="Instantuse",this.hudAddition=et,this.instantUseEnabled=!0,this.funcs=new Map([["setInstantUse",t=>{this.instantUseEnabled=t}]])}init(t){let e=this;t.keybindManager.registerBind({keys:new Set(["enter"]),exclusive:!1,callback(){e.useNearest()}})}useNearest(){var t,e,n,i,s,r,o,a,l,h;let d=null===(s=null===(i=null===(n=null===(e=null===(t=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===t?void 0:t.phaser)||void 0===e?void 0:e.scene)||void 0===n?void 0:n.worldManager)||void 0===i?void 0:i.devices)||void 0===s?void 0:s.devicesInView,u=null===(a=null===(o=null===(r=null===unsafeWindow||void 0===unsafeWindow?void 0:unsafeWindow.stores)||void 0===r?void 0:r.phaser)||void 0===o?void 0:o.mainCharacter)||void 0===a?void 0:a.body;if(!d||!u)return;let c=null,p=1/0;for(let t of d){if(0==t.interactiveZones.zones.length)continue;let e=Math.sqrt(Math.pow(t.x-u.x,2)+Math.pow(t.y-u.y,2));e<p&&(c=t,p=e)}console.log(c),c&&(null===(h=null===(l=null==c?void 0:c.interactiveZones)||void 0===l?void 0:l.onInteraction)||void 0===h||h.call(l))}}class it extends EventTarget{constructor(){super(),this.keybindManager=new y,this.funcs=new Map,this.scripts=[],window.cheat=this,this.socketHandler=new v(this),this.socketHandler.addEventListener("socket",(t=>{st.log("Socket connected",t)})),this.socketHandler.getSocket(),this.hud=new V(this),this.scripts=[new W,new nt,new z,new $,new N,new Q,new J,new Z,new tt],this.initScripts()}initScripts(){for(let t of this.scripts){if(t.funcs)for(let[e,n]of t.funcs)this.funcs.set(e,n);t.hudAddition&&this.hud.loadFromObject(t.hudAddition),t.init&&t.init(this)}}antifreeze(){let t=Object.freeze;Object.freeze=e=>{var n;return"WebSocket"==(null===(n=e.constructor)||void 0===n?void 0:n.name)||"WebSocket"==e.name?e:t(e)};var e=WebSocket.prototype.send;Object.defineProperty(WebSocket.prototype,"send",{configurable:!1,enumerable:!1,get:function(){return e},set:function(t){t!==e&&console.log("Attempted to modify WebSocket.prototype.send")}})}log(...t){console.log("[GC]",...t)}getScript(t){for(let e of this.scripts)if(e.name==t)return e;return null}}const st=new it;st.log("Loaded Gimkit Cheat version: 0.3.4"),st.antifreeze(),Object.isFrozen(WebSocket)&&alert("WebSocket object is still frozen. Please try refreshing the page. If this persists, open an issue on GitHub.")}();
